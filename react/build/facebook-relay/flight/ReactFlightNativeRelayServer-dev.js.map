{"version":3,"file":"ReactFlightNativeRelayServer-dev.js","sources":["../../../packages/shared/ReactSharedInternals.js","../../../packages/shared/consoleWithStackDev.js","../../../packages/shared/hasOwnProperty.js","../../../packages/shared/isArray.js","../../../packages/react-server-native-relay/src/ReactFlightNativeRelayServerHostConfig.js","../../../packages/shared/ReactSymbols.js","../../../packages/react-server/src/ReactServerStreamConfigNode.js","../../../packages/react-native-renderer/src/server/ReactNativeServerFormatConfig.js","../../../packages/react-server/src/ReactFlightNewContext.js","../../../packages/react-server/src/ReactFlightHooks.js","../../../packages/shared/ReactServerContextRegistry.js","../../../packages/react-server/src/ReactFlightServer.js","../../../packages/react-server-native-relay/src/ReactFlightNativeRelayServer.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\n\nconst ReactSharedInternals =\n  React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\nexport default ReactSharedInternals;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\n\nlet suppressWarning = false;\nexport function setSuppressWarning(newSuppressWarning) {\n  if (__DEV__) {\n    suppressWarning = newSuppressWarning;\n  }\n}\n\n// In DEV, calls to console.warn and console.error get replaced\n// by calls to these methods by a Babel plugin.\n//\n// In PROD (or in packages without access to React internals),\n// they are left as they are instead.\n\nexport function warn(format, ...args) {\n  if (__DEV__) {\n    if (!suppressWarning) {\n      printWarning('warn', format, args);\n    }\n  }\n}\n\nexport function error(format, ...args) {\n  if (__DEV__) {\n    if (!suppressWarning) {\n      printWarning('error', format, args);\n    }\n  }\n}\n\nfunction printWarning(level, format, args) {\n  // When changing this logic, you might want to also\n  // update consoleWithStackDev.www.js as well.\n  if (__DEV__) {\n    const ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\n    const stack = ReactDebugCurrentFrame.getStackAddendum();\n    if (stack !== '') {\n      format += '%s';\n      args = args.concat([stack]);\n    }\n\n    // eslint-disable-next-line react-internal/safe-string-coercion\n    const argsWithFormat = args.map(item => String(item));\n    // Careful: RN currently depends on this prefix\n    argsWithFormat.unshift('Warning: ' + format);\n    // We intentionally don't use spread (or .apply) directly because it\n    // breaks IE9: https://github.com/facebook/react/issues/13610\n    // eslint-disable-next-line react-internal/no-production-logging\n    Function.prototype.apply.call(console[level], console, argsWithFormat);\n  }\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\nexport default hasOwnProperty;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\ndeclare function isArray(a: mixed): boolean %checks(Array.isArray(a));\n\nconst isArrayImpl = Array.isArray;\n\n// eslint-disable-next-line no-redeclare\nfunction isArray(a: mixed): boolean {\n  return isArrayImpl(a);\n}\n\nexport default isArray;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {RowEncoding, JSONValue} from './ReactFlightNativeRelayProtocol';\nimport type {Request, ReactModel} from 'react-server/src/ReactFlightServer';\nimport hasOwnProperty from 'shared/hasOwnProperty';\nimport isArray from 'shared/isArray';\nimport type {JSResourceReference} from 'JSResourceReference';\nimport JSResourceReferenceImpl from 'JSResourceReferenceImpl';\n\nexport type ModuleReference<T> = JSResourceReference<T>;\n\nimport type {\n  Destination,\n  BundlerConfig,\n  ModuleMetaData,\n} from 'ReactFlightNativeRelayServerIntegration';\n\nimport {resolveModelToJSON} from 'react-server/src/ReactFlightServer';\n\nimport {\n  emitRow,\n  close,\n  resolveModuleMetaData as resolveModuleMetaDataImpl,\n} from 'ReactFlightNativeRelayServerIntegration';\n\nexport type {\n  Destination,\n  BundlerConfig,\n  ModuleMetaData,\n} from 'ReactFlightNativeRelayServerIntegration';\n\nexport function isModuleReference(reference: Object): boolean {\n  return reference instanceof JSResourceReferenceImpl;\n}\n\nexport type ModuleKey = ModuleReference<any>;\n\nexport function getModuleKey(reference: ModuleReference<any>): ModuleKey {\n  // We use the reference object itself as the key because we assume the\n  // object will be cached by the bundler runtime.\n  return reference;\n}\n\nexport function resolveModuleMetaData<T>(\n  config: BundlerConfig,\n  resource: ModuleReference<T>,\n): ModuleMetaData {\n  return resolveModuleMetaDataImpl(config, resource);\n}\n\nexport type Chunk = RowEncoding;\n\nexport function processErrorChunk(\n  request: Request,\n  id: number,\n  message: string,\n  stack: string,\n): Chunk {\n  return [\n    'E',\n    id,\n    {\n      message,\n      stack,\n    },\n  ];\n}\n\nfunction convertModelToJSON(\n  request: Request,\n  parent: {+[key: string]: ReactModel} | $ReadOnlyArray<ReactModel>,\n  key: string,\n  model: ReactModel,\n): JSONValue {\n  const json = resolveModelToJSON(request, parent, key, model);\n  if (typeof json === 'object' && json !== null) {\n    if (isArray(json)) {\n      const jsonArray: Array<JSONValue> = [];\n      for (let i = 0; i < json.length; i++) {\n        jsonArray[i] = convertModelToJSON(request, json, '' + i, json[i]);\n      }\n      return jsonArray;\n    } else {\n      const jsonObj: {[key: string]: JSONValue} = {};\n      for (const nextKey in json) {\n        if (hasOwnProperty.call(json, nextKey)) {\n          jsonObj[nextKey] = convertModelToJSON(\n            request,\n            json,\n            nextKey,\n            json[nextKey],\n          );\n        }\n      }\n      return jsonObj;\n    }\n  }\n  return json;\n}\n\nexport function processModelChunk(\n  request: Request,\n  id: number,\n  model: ReactModel,\n): Chunk {\n  const json = convertModelToJSON(request, {}, '', model);\n  return ['J', id, json];\n}\n\nexport function processReferenceChunk(\n  request: Request,\n  id: number,\n  reference: string,\n): Chunk {\n  return ['J', id, reference];\n}\n\nexport function processModuleChunk(\n  request: Request,\n  id: number,\n  moduleMetaData: ModuleMetaData,\n): Chunk {\n  // The moduleMetaData is already a JSON serializable value.\n  return ['M', id, moduleMetaData];\n}\n\nexport function processProviderChunk(\n  request: Request,\n  id: number,\n  contextName: string,\n): Chunk {\n  return ['P', id, contextName];\n}\n\nexport function processSymbolChunk(\n  request: Request,\n  id: number,\n  name: string,\n): Chunk {\n  return ['S', id, name];\n}\n\nexport function scheduleWork(callback: () => void) {\n  callback();\n}\n\nexport function flushBuffered(destination: Destination) {}\n\nexport function beginWriting(destination: Destination) {}\n\nexport function writeChunk(destination: Destination, chunk: Chunk): void {\n  emitRow(destination, chunk);\n}\n\nexport function writeChunkAndReturn(\n  destination: Destination,\n  chunk: Chunk,\n): boolean {\n  emitRow(destination, chunk);\n  return true;\n}\n\nexport function completeWriting(destination: Destination) {}\n\nexport {close};\n\nexport function closeWithError(destination: Destination, error: mixed): void {\n  close(destination);\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n// ATTENTION\n// When adding new symbols to this file,\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\n\n// The Symbol used to tag the ReactElement-like types.\nexport const REACT_ELEMENT_TYPE = Symbol.for('react.element');\nexport const REACT_PORTAL_TYPE = Symbol.for('react.portal');\nexport const REACT_FRAGMENT_TYPE = Symbol.for('react.fragment');\nexport const REACT_STRICT_MODE_TYPE = Symbol.for('react.strict_mode');\nexport const REACT_PROFILER_TYPE = Symbol.for('react.profiler');\nexport const REACT_PROVIDER_TYPE = Symbol.for('react.provider');\nexport const REACT_CONTEXT_TYPE = Symbol.for('react.context');\nexport const REACT_SERVER_CONTEXT_TYPE = Symbol.for('react.server_context');\nexport const REACT_FORWARD_REF_TYPE = Symbol.for('react.forward_ref');\nexport const REACT_SUSPENSE_TYPE = Symbol.for('react.suspense');\nexport const REACT_SUSPENSE_LIST_TYPE = Symbol.for('react.suspense_list');\nexport const REACT_MEMO_TYPE = Symbol.for('react.memo');\nexport const REACT_LAZY_TYPE = Symbol.for('react.lazy');\nexport const REACT_SCOPE_TYPE = Symbol.for('react.scope');\nexport const REACT_DEBUG_TRACING_MODE_TYPE = Symbol.for(\n  'react.debug_trace_mode',\n);\nexport const REACT_OFFSCREEN_TYPE = Symbol.for('react.offscreen');\nexport const REACT_LEGACY_HIDDEN_TYPE = Symbol.for('react.legacy_hidden');\nexport const REACT_CACHE_TYPE = Symbol.for('react.cache');\nexport const REACT_TRACING_MARKER_TYPE = Symbol.for('react.tracing_marker');\nexport const REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED = Symbol.for(\n  'react.default_value',\n);\n\nconst MAYBE_ITERATOR_SYMBOL = Symbol.iterator;\nconst FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nexport function getIteratorFn(maybeIterable: ?any): ?() => ?Iterator<*> {\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\n    return null;\n  }\n  const maybeIterator =\n    (MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL]) ||\n    maybeIterable[FAUX_ITERATOR_SYMBOL];\n  if (typeof maybeIterator === 'function') {\n    return maybeIterator;\n  }\n  return null;\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Writable} from 'stream';\nimport {TextEncoder} from 'util';\n\ntype MightBeFlushable = {\n  flush?: () => void,\n  ...\n};\n\nexport type Destination = Writable & MightBeFlushable;\n\nexport type PrecomputedChunk = Uint8Array;\nexport type Chunk = string;\n\nexport function scheduleWork(callback: () => void) {\n  setImmediate(callback);\n}\n\nexport function flushBuffered(destination: Destination) {\n  // If we don't have any more data to send right now.\n  // Flush whatever is in the buffer to the wire.\n  if (typeof destination.flush === 'function') {\n    // By convention the Zlib streams provide a flush function for this purpose.\n    // For Express, compression middleware adds this method.\n    destination.flush();\n  }\n}\n\nconst VIEW_SIZE = 2048;\nlet currentView = null;\nlet writtenBytes = 0;\nlet destinationHasCapacity = true;\n\nexport function beginWriting(destination: Destination) {\n  currentView = new Uint8Array(VIEW_SIZE);\n  writtenBytes = 0;\n  destinationHasCapacity = true;\n}\n\nfunction writeStringChunk(destination: Destination, stringChunk: string) {\n  if (stringChunk.length === 0) {\n    return;\n  }\n  // maximum possible view needed to encode entire string\n  if (stringChunk.length * 3 > VIEW_SIZE) {\n    if (writtenBytes > 0) {\n      writeToDestination(\n        destination,\n        ((currentView: any): Uint8Array).subarray(0, writtenBytes),\n      );\n      currentView = new Uint8Array(VIEW_SIZE);\n      writtenBytes = 0;\n    }\n    writeToDestination(destination, textEncoder.encode(stringChunk));\n    return;\n  }\n\n  let target: Uint8Array = (currentView: any);\n  if (writtenBytes > 0) {\n    target = ((currentView: any): Uint8Array).subarray(writtenBytes);\n  }\n  const {read, written} = textEncoder.encodeInto(stringChunk, target);\n  writtenBytes += written;\n\n  if (read < stringChunk.length) {\n    writeToDestination(destination, (currentView: any));\n    currentView = new Uint8Array(VIEW_SIZE);\n    writtenBytes = textEncoder.encodeInto(stringChunk.slice(read), currentView)\n      .written;\n  }\n\n  if (writtenBytes === VIEW_SIZE) {\n    writeToDestination(destination, (currentView: any));\n    currentView = new Uint8Array(VIEW_SIZE);\n    writtenBytes = 0;\n  }\n}\n\nfunction writeViewChunk(destination: Destination, chunk: PrecomputedChunk) {\n  if (chunk.byteLength === 0) {\n    return;\n  }\n  if (chunk.byteLength > VIEW_SIZE) {\n    // this chunk may overflow a single view which implies it was not\n    // one that is cached by the streaming renderer. We will enqueu\n    // it directly and expect it is not re-used\n    if (writtenBytes > 0) {\n      writeToDestination(\n        destination,\n        ((currentView: any): Uint8Array).subarray(0, writtenBytes),\n      );\n      currentView = new Uint8Array(VIEW_SIZE);\n      writtenBytes = 0;\n    }\n    writeToDestination(destination, chunk);\n    return;\n  }\n\n  let bytesToWrite = chunk;\n  const allowableBytes = ((currentView: any): Uint8Array).length - writtenBytes;\n  if (allowableBytes < bytesToWrite.byteLength) {\n    // this chunk would overflow the current view. We enqueue a full view\n    // and start a new view with the remaining chunk\n    if (allowableBytes === 0) {\n      // the current view is already full, send it\n      writeToDestination(destination, (currentView: any));\n    } else {\n      // fill up the current view and apply the remaining chunk bytes\n      // to a new view.\n      ((currentView: any): Uint8Array).set(\n        bytesToWrite.subarray(0, allowableBytes),\n        writtenBytes,\n      );\n      writtenBytes += allowableBytes;\n      writeToDestination(destination, (currentView: any));\n      bytesToWrite = bytesToWrite.subarray(allowableBytes);\n    }\n    currentView = new Uint8Array(VIEW_SIZE);\n    writtenBytes = 0;\n  }\n  ((currentView: any): Uint8Array).set(bytesToWrite, writtenBytes);\n  writtenBytes += bytesToWrite.byteLength;\n\n  if (writtenBytes === VIEW_SIZE) {\n    writeToDestination(destination, (currentView: any));\n    currentView = new Uint8Array(VIEW_SIZE);\n    writtenBytes = 0;\n  }\n}\n\nexport function writeChunk(\n  destination: Destination,\n  chunk: PrecomputedChunk | Chunk,\n): void {\n  if (typeof chunk === 'string') {\n    writeStringChunk(destination, chunk);\n  } else {\n    writeViewChunk(destination, ((chunk: any): PrecomputedChunk));\n  }\n}\n\nfunction writeToDestination(destination: Destination, view: Uint8Array) {\n  const currentHasCapacity = destination.write(view);\n  destinationHasCapacity = destinationHasCapacity && currentHasCapacity;\n}\n\nexport function writeChunkAndReturn(\n  destination: Destination,\n  chunk: PrecomputedChunk | Chunk,\n): boolean {\n  writeChunk(destination, chunk);\n  return destinationHasCapacity;\n}\n\nexport function completeWriting(destination: Destination) {\n  if (currentView && writtenBytes > 0) {\n    destination.write(currentView.subarray(0, writtenBytes));\n  }\n  currentView = null;\n  writtenBytes = 0;\n  destinationHasCapacity = true;\n}\n\nexport function close(destination: Destination) {\n  destination.end();\n}\n\nconst textEncoder = new TextEncoder();\n\nexport function stringToChunk(content: string): Chunk {\n  return content;\n}\n\nexport function stringToPrecomputedChunk(content: string): PrecomputedChunk {\n  return textEncoder.encode(content);\n}\n\nexport function closeWithError(destination: Destination, error: mixed): void {\n  // $FlowFixMe: This is an Error object or the destination accepts other types.\n  destination.destroy(error);\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {ReactNodeList} from 'shared/ReactTypes';\n\nimport type {\n  Destination,\n  Chunk,\n  PrecomputedChunk,\n} from 'react-server/src/ReactServerStreamConfig';\n\nimport {\n  writeChunk,\n  writeChunkAndReturn,\n  stringToChunk,\n  stringToPrecomputedChunk,\n} from 'react-server/src/ReactServerStreamConfig';\n\nexport const isPrimaryRenderer = true;\n\n// Every list of children or string is null terminated.\nconst END_TAG = 0;\n// Tree node tags.\nconst INSTANCE_TAG = 1;\nconst PLACEHOLDER_TAG = 2;\nconst SUSPENSE_PENDING_TAG = 3;\nconst SUSPENSE_COMPLETE_TAG = 4;\nconst SUSPENSE_CLIENT_RENDER_TAG = 5;\n// Command tags.\nconst SEGMENT_TAG = 1;\nconst SUSPENSE_UPDATE_TO_COMPLETE_TAG = 2;\nconst SUSPENSE_UPDATE_TO_CLIENT_RENDER_TAG = 3;\n\nconst END = new Uint8Array(1);\nEND[0] = END_TAG;\nconst PLACEHOLDER = new Uint8Array(1);\nPLACEHOLDER[0] = PLACEHOLDER_TAG;\nconst INSTANCE = new Uint8Array(1);\nINSTANCE[0] = INSTANCE_TAG;\nconst SUSPENSE_PENDING = new Uint8Array(1);\nSUSPENSE_PENDING[0] = SUSPENSE_PENDING_TAG;\nconst SUSPENSE_COMPLETE = new Uint8Array(1);\nSUSPENSE_COMPLETE[0] = SUSPENSE_COMPLETE_TAG;\nconst SUSPENSE_CLIENT_RENDER = new Uint8Array(1);\nSUSPENSE_CLIENT_RENDER[0] = SUSPENSE_CLIENT_RENDER_TAG;\n\nconst SEGMENT = new Uint8Array(1);\nSEGMENT[0] = SEGMENT_TAG;\nconst SUSPENSE_UPDATE_TO_COMPLETE = new Uint8Array(1);\nSUSPENSE_UPDATE_TO_COMPLETE[0] = SUSPENSE_UPDATE_TO_COMPLETE_TAG;\nconst SUSPENSE_UPDATE_TO_CLIENT_RENDER = new Uint8Array(1);\nSUSPENSE_UPDATE_TO_CLIENT_RENDER[0] = SUSPENSE_UPDATE_TO_CLIENT_RENDER_TAG;\n\n// Per response,\nexport type ResponseState = {\n  nextSuspenseID: number,\n};\n\n// Allows us to keep track of what we've already written so we can refer back to it.\nexport function createResponseState(): ResponseState {\n  return {\n    nextSuspenseID: 0,\n  };\n}\n\n// isInAParentText\nexport type FormatContext = boolean;\n\nexport function createRootFormatContext(): FormatContext {\n  return false;\n}\n\nexport function getChildFormatContext(\n  parentContext: FormatContext,\n  type: string,\n  props: Object,\n): FormatContext {\n  const prevIsInAParentText = parentContext;\n  const isInAParentText =\n    type === 'AndroidTextInput' || // Android\n    type === 'RCTMultilineTextInputView' || // iOS\n    type === 'RCTSinglelineTextInputView' || // iOS\n    type === 'RCTText' ||\n    type === 'RCTVirtualText';\n\n  if (prevIsInAParentText !== isInAParentText) {\n    return isInAParentText;\n  } else {\n    return parentContext;\n  }\n}\n\n// This object is used to lazily reuse the ID of the first generated node, or assign one.\n// This is very specific to DOM where we can't assign an ID to.\nexport type SuspenseBoundaryID = number;\n\nexport const UNINITIALIZED_SUSPENSE_BOUNDARY_ID = -1;\n\nexport function assignSuspenseBoundaryID(\n  responseState: ResponseState,\n): SuspenseBoundaryID {\n  return responseState.nextSuspenseID++;\n}\n\nexport function makeId(\n  responseState: ResponseState,\n  treeId: string,\n  localId: number,\n): string {\n  throw new Error('Not implemented');\n}\n\nconst RAW_TEXT = stringToPrecomputedChunk('RCTRawText');\n\nexport function pushTextInstance(\n  target: Array<Chunk | PrecomputedChunk>,\n  text: string,\n  responseState: ResponseState,\n  // This Renderer does not use this argument\n  textEmbedded: boolean,\n): boolean {\n  target.push(\n    INSTANCE,\n    RAW_TEXT, // Type\n    END, // Null terminated type string\n    // TODO: props { text: text }\n    END, // End of children\n  );\n  return false;\n}\n\nexport function pushStartInstance(\n  target: Array<Chunk | PrecomputedChunk>,\n  type: string,\n  props: Object,\n  responseState: ResponseState,\n  formatContext: FormatContext,\n): ReactNodeList {\n  target.push(\n    INSTANCE,\n    stringToChunk(type),\n    END, // Null terminated type string\n    // TODO: props\n  );\n  return props.children;\n}\n\nexport function pushEndInstance(\n  target: Array<Chunk | PrecomputedChunk>,\n  type: string,\n  props: Object,\n): void {\n  target.push(END);\n}\n\n// In this Renderer this is a noop\nexport function pushSegmentFinale(\n  target: Array<Chunk | PrecomputedChunk>,\n  responseState: ResponseState,\n  lastPushedText: boolean,\n  textEmbedded: boolean,\n): void {}\n\nexport function writeCompletedRoot(\n  destination: Destination,\n  responseState: ResponseState,\n): boolean {\n  return true;\n}\n\n// IDs are formatted as little endian Uint16\nfunction formatID(id: number): Uint8Array {\n  if (id > 0xffff) {\n    throw new Error(\n      'More boundaries or placeholders than we expected to ever emit.',\n    );\n  }\n  const buffer = new Uint8Array(2);\n  buffer[0] = (id >>> 8) & 0xff;\n  buffer[1] = id & 0xff;\n  return buffer;\n}\n\n// Structural Nodes\n\n// A placeholder is a node inside a hidden partial tree that can be filled in later, but before\n// display. It's never visible to users.\nexport function writePlaceholder(\n  destination: Destination,\n  responseState: ResponseState,\n  id: number,\n): boolean {\n  writeChunk(destination, PLACEHOLDER);\n  return writeChunkAndReturn(destination, formatID(id));\n}\n\n// Suspense boundaries are encoded as comments.\nexport function writeStartCompletedSuspenseBoundary(\n  destination: Destination,\n  responseState: ResponseState,\n): boolean {\n  return writeChunkAndReturn(destination, SUSPENSE_COMPLETE);\n}\n\nexport function pushStartCompletedSuspenseBoundary(\n  target: Array<Chunk | PrecomputedChunk>,\n): void {\n  target.push(SUSPENSE_COMPLETE);\n}\n\nexport function writeStartPendingSuspenseBoundary(\n  destination: Destination,\n  responseState: ResponseState,\n  id: SuspenseBoundaryID,\n): boolean {\n  writeChunk(destination, SUSPENSE_PENDING);\n  return writeChunkAndReturn(destination, formatID(id));\n}\nexport function writeStartClientRenderedSuspenseBoundary(\n  destination: Destination,\n  responseState: ResponseState,\n  // TODO: encode error for native\n  errorDigest: ?string,\n  errorMessage: ?string,\n  errorComponentStack: ?string,\n): boolean {\n  return writeChunkAndReturn(destination, SUSPENSE_CLIENT_RENDER);\n}\nexport function writeEndCompletedSuspenseBoundary(\n  destination: Destination,\n  responseState: ResponseState,\n): boolean {\n  return writeChunkAndReturn(destination, END);\n}\nexport function pushEndCompletedSuspenseBoundary(\n  target: Array<Chunk | PrecomputedChunk>,\n): void {\n  target.push(END);\n}\nexport function writeEndPendingSuspenseBoundary(\n  destination: Destination,\n  responseState: ResponseState,\n): boolean {\n  return writeChunkAndReturn(destination, END);\n}\nexport function writeEndClientRenderedSuspenseBoundary(\n  destination: Destination,\n  responseState: ResponseState,\n): boolean {\n  return writeChunkAndReturn(destination, END);\n}\n\nexport function writeStartSegment(\n  destination: Destination,\n  responseState: ResponseState,\n  formatContext: FormatContext,\n  id: number,\n): boolean {\n  writeChunk(destination, SEGMENT);\n  return writeChunkAndReturn(destination, formatID(id));\n}\nexport function writeEndSegment(\n  destination: Destination,\n  formatContext: FormatContext,\n): boolean {\n  return writeChunkAndReturn(destination, END);\n}\n\n// Instruction Set\n\nexport function writeCompletedSegmentInstruction(\n  destination: Destination,\n  responseState: ResponseState,\n  contentSegmentID: number,\n): boolean {\n  // We don't need to emit this. Instead the client will keep track of pending placeholders.\n  // TODO: Returning true here is not correct. Avoid having to call this function at all.\n  return true;\n}\n\nexport function writeCompletedBoundaryInstruction(\n  destination: Destination,\n  responseState: ResponseState,\n  boundaryID: SuspenseBoundaryID,\n  contentSegmentID: number,\n): boolean {\n  writeChunk(destination, SUSPENSE_UPDATE_TO_COMPLETE);\n  writeChunk(destination, formatID(boundaryID));\n  return writeChunkAndReturn(destination, formatID(contentSegmentID));\n}\n\nexport function writeClientRenderBoundaryInstruction(\n  destination: Destination,\n  responseState: ResponseState,\n  boundaryID: SuspenseBoundaryID,\n  // TODO: encode error for native\n  errorDigest: ?string,\n  errorMessage: ?string,\n  errorComponentStack: ?string,\n): boolean {\n  writeChunk(destination, SUSPENSE_UPDATE_TO_CLIENT_RENDER);\n  return writeChunkAndReturn(destination, formatID(boundaryID));\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {\n  ReactServerContext,\n  ServerContextJSONValue,\n} from 'shared/ReactTypes';\n\nimport {REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED} from 'shared/ReactSymbols';\nimport {isPrimaryRenderer} from './ReactServerFormatConfig';\n\nlet rendererSigil;\nif (__DEV__) {\n  // Use this to detect multiple renderers using the same context\n  rendererSigil = {};\n}\n\n// Used to store the parent path of all context overrides in a shared linked list.\n// Forming a reverse tree.\ntype ContextNode<T: ServerContextJSONValue> = {\n  parent: null | ContextNode<any>,\n  depth: number, // Short hand to compute the depth of the tree at this node.\n  context: ReactServerContext<T>,\n  parentValue: T,\n  value: T,\n};\n\n// The structure of a context snapshot is an implementation of this file.\n// Currently, it's implemented as tracking the current active node.\nexport opaque type ContextSnapshot = null | ContextNode<any>;\n\nexport const rootContextSnapshot: ContextSnapshot = null;\n\n// We assume that this runtime owns the \"current\" field on all ReactContext instances.\n// This global (actually thread local) state represents what state all those \"current\",\n// fields are currently in.\nlet currentActiveSnapshot: ContextSnapshot = null;\n\nfunction popNode(prev: ContextNode<any>): void {\n  if (isPrimaryRenderer) {\n    prev.context._currentValue = prev.parentValue;\n  } else {\n    prev.context._currentValue2 = prev.parentValue;\n  }\n}\n\nfunction pushNode(next: ContextNode<any>): void {\n  if (isPrimaryRenderer) {\n    next.context._currentValue = next.value;\n  } else {\n    next.context._currentValue2 = next.value;\n  }\n}\n\nfunction popToNearestCommonAncestor(\n  prev: ContextNode<any>,\n  next: ContextNode<any>,\n): void {\n  if (prev === next) {\n    // We've found a shared ancestor. We don't need to pop nor reapply this one or anything above.\n  } else {\n    popNode(prev);\n    const parentPrev = prev.parent;\n    const parentNext = next.parent;\n    if (parentPrev === null) {\n      if (parentNext !== null) {\n        throw new Error(\n          'The stacks must reach the root at the same time. This is a bug in React.',\n        );\n      }\n    } else {\n      if (parentNext === null) {\n        throw new Error(\n          'The stacks must reach the root at the same time. This is a bug in React.',\n        );\n      }\n\n      popToNearestCommonAncestor(parentPrev, parentNext);\n      // On the way back, we push the new ones that weren't common.\n      pushNode(next);\n    }\n  }\n}\n\nfunction popAllPrevious(prev: ContextNode<any>): void {\n  popNode(prev);\n  const parentPrev = prev.parent;\n  if (parentPrev !== null) {\n    popAllPrevious(parentPrev);\n  }\n}\n\nfunction pushAllNext(next: ContextNode<any>): void {\n  const parentNext = next.parent;\n  if (parentNext !== null) {\n    pushAllNext(parentNext);\n  }\n  pushNode(next);\n}\n\nfunction popPreviousToCommonLevel(\n  prev: ContextNode<any>,\n  next: ContextNode<any>,\n): void {\n  popNode(prev);\n  const parentPrev = prev.parent;\n\n  if (parentPrev === null) {\n    throw new Error(\n      'The depth must equal at least at zero before reaching the root. This is a bug in React.',\n    );\n  }\n\n  if (parentPrev.depth === next.depth) {\n    // We found the same level. Now we just need to find a shared ancestor.\n    popToNearestCommonAncestor(parentPrev, next);\n  } else {\n    // We must still be deeper.\n    popPreviousToCommonLevel(parentPrev, next);\n  }\n}\n\nfunction popNextToCommonLevel(\n  prev: ContextNode<any>,\n  next: ContextNode<any>,\n): void {\n  const parentNext = next.parent;\n\n  if (parentNext === null) {\n    throw new Error(\n      'The depth must equal at least at zero before reaching the root. This is a bug in React.',\n    );\n  }\n\n  if (prev.depth === parentNext.depth) {\n    // We found the same level. Now we just need to find a shared ancestor.\n    popToNearestCommonAncestor(prev, parentNext);\n  } else {\n    // We must still be deeper.\n    popNextToCommonLevel(prev, parentNext);\n  }\n  pushNode(next);\n}\n\n// Perform context switching to the new snapshot.\n// To make it cheap to read many contexts, while not suspending, we make the switch eagerly by\n// updating all the context's current values. That way reads, always just read the current value.\n// At the cost of updating contexts even if they're never read by this subtree.\nexport function switchContext(newSnapshot: ContextSnapshot): void {\n  // The basic algorithm we need to do is to pop back any contexts that are no longer on the stack.\n  // We also need to update any new contexts that are now on the stack with the deepest value.\n  // The easiest way to update new contexts is to just reapply them in reverse order from the\n  // perspective of the backpointers. To avoid allocating a lot when switching, we use the stack\n  // for that. Therefore this algorithm is recursive.\n  // 1) First we pop which ever snapshot tree was deepest. Popping old contexts as we go.\n  // 2) Then we find the nearest common ancestor from there. Popping old contexts as we go.\n  // 3) Then we reapply new contexts on the way back up the stack.\n  const prev = currentActiveSnapshot;\n  const next = newSnapshot;\n  if (prev !== next) {\n    if (prev === null) {\n      // $FlowFixMe: This has to be non-null since it's not equal to prev.\n      pushAllNext(next);\n    } else if (next === null) {\n      popAllPrevious(prev);\n    } else if (prev.depth === next.depth) {\n      popToNearestCommonAncestor(prev, next);\n    } else if (prev.depth > next.depth) {\n      popPreviousToCommonLevel(prev, next);\n    } else {\n      popNextToCommonLevel(prev, next);\n    }\n    currentActiveSnapshot = next;\n  }\n}\n\nexport function pushProvider<T: ServerContextJSONValue>(\n  context: ReactServerContext<T>,\n  nextValue: T,\n): ContextSnapshot {\n  let prevValue;\n  if (isPrimaryRenderer) {\n    prevValue = context._currentValue;\n    context._currentValue = nextValue;\n    if (__DEV__) {\n      if (\n        context._currentRenderer !== undefined &&\n        context._currentRenderer !== null &&\n        context._currentRenderer !== rendererSigil\n      ) {\n        console.error(\n          'Detected multiple renderers concurrently rendering the ' +\n            'same context provider. This is currently unsupported.',\n        );\n      }\n      context._currentRenderer = rendererSigil;\n    }\n  } else {\n    prevValue = context._currentValue2;\n    context._currentValue2 = nextValue;\n    if (__DEV__) {\n      if (\n        context._currentRenderer2 !== undefined &&\n        context._currentRenderer2 !== null &&\n        context._currentRenderer2 !== rendererSigil\n      ) {\n        console.error(\n          'Detected multiple renderers concurrently rendering the ' +\n            'same context provider. This is currently unsupported.',\n        );\n      }\n      context._currentRenderer2 = rendererSigil;\n    }\n  }\n  const prevNode = currentActiveSnapshot;\n  const newNode: ContextNode<T> = {\n    parent: prevNode,\n    depth: prevNode === null ? 0 : prevNode.depth + 1,\n    context: context,\n    parentValue: prevValue,\n    value: nextValue,\n  };\n  currentActiveSnapshot = newNode;\n  return newNode;\n}\n\nexport function popProvider(): ContextSnapshot {\n  const prevSnapshot = currentActiveSnapshot;\n\n  if (prevSnapshot === null) {\n    throw new Error(\n      'Tried to pop a Context at the root of the app. This is a bug in React.',\n    );\n  }\n\n  if (isPrimaryRenderer) {\n    const value = prevSnapshot.parentValue;\n    if (value === REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED) {\n      prevSnapshot.context._currentValue = prevSnapshot.context._defaultValue;\n    } else {\n      prevSnapshot.context._currentValue = value;\n    }\n  } else {\n    const value = prevSnapshot.parentValue;\n    if (value === REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED) {\n      prevSnapshot.context._currentValue2 = prevSnapshot.context._defaultValue;\n    } else {\n      prevSnapshot.context._currentValue2 = value;\n    }\n  }\n  return (currentActiveSnapshot = prevSnapshot.parent);\n}\n\nexport function getActiveContext(): ContextSnapshot {\n  return currentActiveSnapshot;\n}\n\nexport function readContext<T>(context: ReactServerContext<T>): T {\n  const value = isPrimaryRenderer\n    ? context._currentValue\n    : context._currentValue2;\n  return value;\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Dispatcher as DispatcherType} from 'react-reconciler/src/ReactInternalTypes';\nimport type {Request} from './ReactFlightServer';\nimport type {ReactServerContext} from 'shared/ReactTypes';\nimport {REACT_SERVER_CONTEXT_TYPE} from 'shared/ReactSymbols';\nimport {readContext as readContextImpl} from './ReactFlightNewContext';\n\nlet currentRequest = null;\n\nexport function prepareToUseHooksForRequest(request: Request) {\n  currentRequest = request;\n}\n\nexport function resetHooksForRequest() {\n  currentRequest = null;\n}\n\nfunction readContext<T>(context: ReactServerContext<T>): T {\n  if (__DEV__) {\n    if (context.$$typeof !== REACT_SERVER_CONTEXT_TYPE) {\n      console.error('Only ServerContext is supported in Flight');\n    }\n    if (currentCache === null) {\n      console.error(\n        'Context can only be read while React is rendering. ' +\n          'In classes, you can read it in the render method or getDerivedStateFromProps. ' +\n          'In function components, you can read it directly in the function body, but not ' +\n          'inside Hooks like useReducer() or useMemo().',\n      );\n    }\n  }\n  return readContextImpl(context);\n}\n\nexport const Dispatcher: DispatcherType = {\n  useMemo<T>(nextCreate: () => T): T {\n    return nextCreate();\n  },\n  useCallback<T>(callback: T): T {\n    return callback;\n  },\n  useDebugValue(): void {},\n  useDeferredValue: (unsupportedHook: any),\n  useTransition: (unsupportedHook: any),\n  getCacheForType<T>(resourceType: () => T): T {\n    if (!currentCache) {\n      throw new Error('Reading the cache is only supported while rendering.');\n    }\n\n    let entry: T | void = (currentCache.get(resourceType): any);\n    if (entry === undefined) {\n      entry = resourceType();\n      // TODO: Warn if undefined?\n      currentCache.set(resourceType, entry);\n    }\n    return entry;\n  },\n  readContext,\n  useContext: readContext,\n  useReducer: (unsupportedHook: any),\n  useRef: (unsupportedHook: any),\n  useState: (unsupportedHook: any),\n  useInsertionEffect: (unsupportedHook: any),\n  useLayoutEffect: (unsupportedHook: any),\n  useImperativeHandle: (unsupportedHook: any),\n  useEffect: (unsupportedHook: any),\n  useId,\n  useMutableSource: (unsupportedHook: any),\n  useSyncExternalStore: (unsupportedHook: any),\n  useCacheRefresh(): <T>(?() => T, ?T) => void {\n    return unsupportedRefresh;\n  },\n};\n\nfunction unsupportedHook(): void {\n  throw new Error('This Hook is not supported in Server Components.');\n}\n\nfunction unsupportedRefresh(): void {\n  if (!currentCache) {\n    throw new Error(\n      'Refreshing the cache is not supported in Server Components.',\n    );\n  }\n}\n\nlet currentCache: Map<Function, mixed> | null = null;\n\nexport function setCurrentCache(cache: Map<Function, mixed> | null) {\n  currentCache = cache;\n  return currentCache;\n}\n\nexport function getCurrentCache() {\n  return currentCache;\n}\n\nfunction useId(): string {\n  if (currentRequest === null) {\n    throw new Error('useId can only be used while React is rendering');\n  }\n  const id = currentRequest.identifierCount++;\n  // use 'S' for Flight components to distinguish from 'R' and 'r' in Fizz/Client\n  return ':' + currentRequest.identifierPrefix + 'S' + id.toString(32) + ':';\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED} from 'shared/ReactSymbols';\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\nimport {createServerContext} from 'react';\n\nconst ContextRegistry = ReactSharedInternals.ContextRegistry;\n\nexport function getOrCreateServerContext(globalName: string) {\n  if (!ContextRegistry[globalName]) {\n    ContextRegistry[globalName] = createServerContext(\n      globalName,\n      REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED,\n    );\n  }\n  return ContextRegistry[globalName];\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {\n  Destination,\n  Chunk,\n  BundlerConfig,\n  ModuleMetaData,\n  ModuleReference,\n  ModuleKey,\n} from './ReactFlightServerConfig';\nimport type {ContextSnapshot} from './ReactFlightNewContext';\nimport type {\n  ReactProviderType,\n  ServerContextJSONValue,\n} from 'shared/ReactTypes';\n\nimport {\n  scheduleWork,\n  beginWriting,\n  writeChunkAndReturn,\n  completeWriting,\n  flushBuffered,\n  close,\n  closeWithError,\n  processModelChunk,\n  processModuleChunk,\n  processProviderChunk,\n  processSymbolChunk,\n  processErrorChunk,\n  processReferenceChunk,\n  resolveModuleMetaData,\n  getModuleKey,\n  isModuleReference,\n} from './ReactFlightServerConfig';\n\nimport {\n  Dispatcher,\n  getCurrentCache,\n  prepareToUseHooksForRequest,\n  resetHooksForRequest,\n  setCurrentCache,\n} from './ReactFlightHooks';\nimport {\n  pushProvider,\n  popProvider,\n  switchContext,\n  getActiveContext,\n  rootContextSnapshot,\n} from './ReactFlightNewContext';\n\nimport {\n  REACT_ELEMENT_TYPE,\n  REACT_FORWARD_REF_TYPE,\n  REACT_FRAGMENT_TYPE,\n  REACT_LAZY_TYPE,\n  REACT_MEMO_TYPE,\n  REACT_PROVIDER_TYPE,\n} from 'shared/ReactSymbols';\n\nimport {getOrCreateServerContext} from 'shared/ReactServerContextRegistry';\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\nimport isArray from 'shared/isArray';\n\ntype ReactJSONValue =\n  | string\n  | boolean\n  | number\n  | null\n  | $ReadOnlyArray<ReactJSONValue>\n  | ReactModelObject;\n\nexport type ReactModel =\n  | React$Element<any>\n  | string\n  | boolean\n  | number\n  | null\n  | Iterable<ReactModel>\n  | ReactModelObject;\n\ntype ReactModelObject = {+[key: string]: ReactModel};\n\nconst PENDING = 0;\nconst COMPLETED = 1;\nconst ABORTED = 3;\nconst ERRORED = 4;\n\ntype Task = {\n  id: number,\n  status: 0 | 1 | 3 | 4,\n  model: ReactModel,\n  ping: () => void,\n  context: ContextSnapshot,\n};\n\nexport type Request = {\n  status: 0 | 1 | 2,\n  fatalError: mixed,\n  destination: null | Destination,\n  bundlerConfig: BundlerConfig,\n  cache: Map<Function, mixed>,\n  nextChunkId: number,\n  pendingChunks: number,\n  abortableTasks: Set<Task>,\n  pingedTasks: Array<Task>,\n  completedModuleChunks: Array<Chunk>,\n  completedJSONChunks: Array<Chunk>,\n  completedErrorChunks: Array<Chunk>,\n  writtenSymbols: Map<Symbol, number>,\n  writtenModules: Map<ModuleKey, number>,\n  writtenProviders: Map<string, number>,\n  identifierPrefix: string,\n  identifierCount: number,\n  onError: (error: mixed) => void,\n  toJSON: (key: string, value: ReactModel) => ReactJSONValue,\n};\n\nconst ReactCurrentDispatcher = ReactSharedInternals.ReactCurrentDispatcher;\n\nfunction defaultErrorHandler(error: mixed) {\n  console['error'](error);\n  // Don't transform to our wrapper\n}\n\nconst OPEN = 0;\nconst CLOSING = 1;\nconst CLOSED = 2;\n\nexport function createRequest(\n  model: ReactModel,\n  bundlerConfig: BundlerConfig,\n  onError: void | ((error: mixed) => void),\n  context?: Array<[string, ServerContextJSONValue]>,\n  identifierPrefix?: string,\n): Request {\n  const abortSet: Set<Task> = new Set();\n  const pingedTasks = [];\n  const request = {\n    status: OPEN,\n    fatalError: null,\n    destination: null,\n    bundlerConfig,\n    cache: new Map(),\n    nextChunkId: 0,\n    pendingChunks: 0,\n    abortableTasks: abortSet,\n    pingedTasks: pingedTasks,\n    completedModuleChunks: [],\n    completedJSONChunks: [],\n    completedErrorChunks: [],\n    writtenSymbols: new Map(),\n    writtenModules: new Map(),\n    writtenProviders: new Map(),\n    identifierPrefix: identifierPrefix || '',\n    identifierCount: 1,\n    onError: onError === undefined ? defaultErrorHandler : onError,\n    toJSON: function(key: string, value: ReactModel): ReactJSONValue {\n      return resolveModelToJSON(request, this, key, value);\n    },\n  };\n  request.pendingChunks++;\n  const rootContext = createRootContext(context);\n  const rootTask = createTask(request, model, rootContext, abortSet);\n  pingedTasks.push(rootTask);\n  return request;\n}\n\nfunction createRootContext(\n  reqContext?: Array<[string, ServerContextJSONValue]>,\n) {\n  return importServerContexts(reqContext);\n}\n\nconst POP = {};\n\nfunction attemptResolveElement(\n  type: any,\n  key: null | React$Key,\n  ref: mixed,\n  props: any,\n): ReactModel {\n  if (ref !== null && ref !== undefined) {\n    // When the ref moves to the regular props object this will implicitly\n    // throw for functions. We could probably relax it to a DEV warning for other\n    // cases.\n    throw new Error(\n      'Refs cannot be used in server components, nor passed to client components.',\n    );\n  }\n  if (typeof type === 'function') {\n    // This is a server-side component.\n    return type(props);\n  } else if (typeof type === 'string') {\n    // This is a host element. E.g. HTML.\n    return [REACT_ELEMENT_TYPE, type, key, props];\n  } else if (typeof type === 'symbol') {\n    if (type === REACT_FRAGMENT_TYPE) {\n      // For key-less fragments, we add a small optimization to avoid serializing\n      // it as a wrapper.\n      // TODO: If a key is specified, we should propagate its key to any children.\n      // Same as if a server component has a key.\n      return props.children;\n    }\n    // This might be a built-in React component. We'll let the client decide.\n    // Any built-in works as long as its props are serializable.\n    return [REACT_ELEMENT_TYPE, type, key, props];\n  } else if (type != null && typeof type === 'object') {\n    if (isModuleReference(type)) {\n      // This is a reference to a client component.\n      return [REACT_ELEMENT_TYPE, type, key, props];\n    }\n    switch (type.$$typeof) {\n      case REACT_LAZY_TYPE: {\n        const payload = type._payload;\n        const init = type._init;\n        const wrappedType = init(payload);\n        return attemptResolveElement(wrappedType, key, ref, props);\n      }\n      case REACT_FORWARD_REF_TYPE: {\n        const render = type.render;\n        return render(props, undefined);\n      }\n      case REACT_MEMO_TYPE: {\n        return attemptResolveElement(type.type, key, ref, props);\n      }\n      case REACT_PROVIDER_TYPE: {\n        pushProvider(type._context, props.value);\n        if (__DEV__) {\n          const extraKeys = Object.keys(props).filter(value => {\n            if (value === 'children' || value === 'value') {\n              return false;\n            }\n            return true;\n          });\n          if (extraKeys.length !== 0) {\n            console.error(\n              'ServerContext can only have a value prop and children. Found: %s',\n              JSON.stringify(extraKeys),\n            );\n          }\n        }\n        return [\n          REACT_ELEMENT_TYPE,\n          type,\n          key,\n          // Rely on __popProvider being serialized last to pop the provider.\n          {value: props.value, children: props.children, __pop: POP},\n        ];\n      }\n    }\n  }\n  throw new Error(\n    `Unsupported server component type: ${describeValueForErrorMessage(type)}`,\n  );\n}\n\nfunction pingTask(request: Request, task: Task): void {\n  const pingedTasks = request.pingedTasks;\n  pingedTasks.push(task);\n  if (pingedTasks.length === 1) {\n    scheduleWork(() => performWork(request));\n  }\n}\n\nfunction createTask(\n  request: Request,\n  model: ReactModel,\n  context: ContextSnapshot,\n  abortSet: Set<Task>,\n): Task {\n  const id = request.nextChunkId++;\n  const task = {\n    id,\n    status: PENDING,\n    model,\n    context,\n    ping: () => pingTask(request, task),\n  };\n  abortSet.add(task);\n  return task;\n}\n\nfunction serializeByValueID(id: number): string {\n  return '$' + id.toString(16);\n}\n\nfunction serializeByRefID(id: number): string {\n  return '@' + id.toString(16);\n}\n\nfunction escapeStringValue(value: string): string {\n  if (value[0] === '$' || value[0] === '@') {\n    // We need to escape $ or @ prefixed strings since we use those to encode\n    // references to IDs and as special symbol values.\n    return '$' + value;\n  } else {\n    return value;\n  }\n}\n\nfunction isObjectPrototype(object): boolean {\n  if (!object) {\n    return false;\n  }\n  const ObjectPrototype = Object.prototype;\n  if (object === ObjectPrototype) {\n    return true;\n  }\n  // It might be an object from a different Realm which is\n  // still just a plain simple object.\n  if (Object.getPrototypeOf(object)) {\n    return false;\n  }\n  const names = Object.getOwnPropertyNames(object);\n  for (let i = 0; i < names.length; i++) {\n    if (!(names[i] in ObjectPrototype)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction isSimpleObject(object): boolean {\n  if (!isObjectPrototype(Object.getPrototypeOf(object))) {\n    return false;\n  }\n  const names = Object.getOwnPropertyNames(object);\n  for (let i = 0; i < names.length; i++) {\n    const descriptor = Object.getOwnPropertyDescriptor(object, names[i]);\n    if (!descriptor) {\n      return false;\n    }\n    if (!descriptor.enumerable) {\n      if (\n        (names[i] === 'key' || names[i] === 'ref') &&\n        typeof descriptor.get === 'function'\n      ) {\n        // React adds key and ref getters to props objects to issue warnings.\n        // Those getters will not be transferred to the client, but that's ok,\n        // so we'll special case them.\n        continue;\n      }\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction objectName(object): string {\n  const name = Object.prototype.toString.call(object);\n  return name.replace(/^\\[object (.*)\\]$/, function(m, p0) {\n    return p0;\n  });\n}\n\nfunction describeKeyForErrorMessage(key: string): string {\n  const encodedKey = JSON.stringify(key);\n  return '\"' + key + '\"' === encodedKey ? key : encodedKey;\n}\n\nfunction describeValueForErrorMessage(value: ReactModel): string {\n  switch (typeof value) {\n    case 'string': {\n      return JSON.stringify(\n        value.length <= 10 ? value : value.substr(0, 10) + '...',\n      );\n    }\n    case 'object': {\n      if (isArray(value)) {\n        return '[...]';\n      }\n      const name = objectName(value);\n      if (name === 'Object') {\n        return '{...}';\n      }\n      return name;\n    }\n    case 'function':\n      return 'function';\n    default:\n      // eslint-disable-next-line react-internal/safe-string-coercion\n      return String(value);\n  }\n}\n\nfunction describeObjectForErrorMessage(\n  objectOrArray:\n    | {+[key: string | number]: ReactModel}\n    | $ReadOnlyArray<ReactModel>,\n  expandedName?: string,\n): string {\n  if (isArray(objectOrArray)) {\n    let str = '[';\n    const array: $ReadOnlyArray<ReactModel> = objectOrArray;\n    for (let i = 0; i < array.length; i++) {\n      if (i > 0) {\n        str += ', ';\n      }\n      if (i > 6) {\n        str += '...';\n        break;\n      }\n      const value = array[i];\n      if (\n        '' + i === expandedName &&\n        typeof value === 'object' &&\n        value !== null\n      ) {\n        str += describeObjectForErrorMessage(value);\n      } else {\n        str += describeValueForErrorMessage(value);\n      }\n    }\n    str += ']';\n    return str;\n  } else {\n    let str = '{';\n    const object: {+[key: string | number]: ReactModel} = objectOrArray;\n    const names = Object.keys(object);\n    for (let i = 0; i < names.length; i++) {\n      if (i > 0) {\n        str += ', ';\n      }\n      if (i > 6) {\n        str += '...';\n        break;\n      }\n      const name = names[i];\n      str += describeKeyForErrorMessage(name) + ': ';\n      const value = object[name];\n      if (\n        name === expandedName &&\n        typeof value === 'object' &&\n        value !== null\n      ) {\n        str += describeObjectForErrorMessage(value);\n      } else {\n        str += describeValueForErrorMessage(value);\n      }\n    }\n    str += '}';\n    return str;\n  }\n}\n\nlet insideContextProps = null;\nlet isInsideContextValue = false;\n\nexport function resolveModelToJSON(\n  request: Request,\n  parent: {+[key: string | number]: ReactModel} | $ReadOnlyArray<ReactModel>,\n  key: string,\n  value: ReactModel,\n): ReactJSONValue {\n  if (__DEV__) {\n    // $FlowFixMe\n    const originalValue = parent[key];\n    if (typeof originalValue === 'object' && originalValue !== value) {\n      console.error(\n        'Only plain objects can be passed to client components from server components. ' +\n          'Objects with toJSON methods are not supported. Convert it manually ' +\n          'to a simple value before passing it to props. ' +\n          'Remove %s from these props: %s',\n        describeKeyForErrorMessage(key),\n        describeObjectForErrorMessage(parent),\n      );\n    }\n  }\n\n  // Special Symbols\n  switch (value) {\n    case REACT_ELEMENT_TYPE:\n      return '$';\n  }\n\n  if (__DEV__) {\n    if (\n      parent[0] === REACT_ELEMENT_TYPE &&\n      parent[1] &&\n      parent[1].$$typeof === REACT_PROVIDER_TYPE &&\n      key === '3'\n    ) {\n      insideContextProps = value;\n    } else if (insideContextProps === parent && key === 'value') {\n      isInsideContextValue = true;\n    } else if (insideContextProps === parent && key === 'children') {\n      isInsideContextValue = false;\n    }\n  }\n\n  // Resolve server components.\n  while (\n    typeof value === 'object' &&\n    value !== null &&\n    ((value: any).$$typeof === REACT_ELEMENT_TYPE ||\n      (value: any).$$typeof === REACT_LAZY_TYPE)\n  ) {\n    if (__DEV__) {\n      if (isInsideContextValue) {\n        console.error('React elements are not allowed in ServerContext');\n      }\n    }\n\n    try {\n      switch ((value: any).$$typeof) {\n        case REACT_ELEMENT_TYPE: {\n          // TODO: Concatenate keys of parents onto children.\n          const element: React$Element<any> = (value: any);\n          // Attempt to render the server component.\n          value = attemptResolveElement(\n            element.type,\n            element.key,\n            element.ref,\n            element.props,\n          );\n          break;\n        }\n        case REACT_LAZY_TYPE: {\n          const payload = (value: any)._payload;\n          const init = (value: any)._init;\n          value = init(payload);\n          break;\n        }\n      }\n    } catch (x) {\n      if (typeof x === 'object' && x !== null && typeof x.then === 'function') {\n        // Something suspended, we'll need to create a new task and resolve it later.\n        request.pendingChunks++;\n        const newTask = createTask(\n          request,\n          value,\n          getActiveContext(),\n          request.abortableTasks,\n        );\n        const ping = newTask.ping;\n        x.then(ping, ping);\n        return serializeByRefID(newTask.id);\n      } else {\n        logRecoverableError(request, x);\n        // Something errored. We'll still send everything we have up until this point.\n        // We'll replace this element with a lazy reference that throws on the client\n        // once it gets rendered.\n        request.pendingChunks++;\n        const errorId = request.nextChunkId++;\n        emitErrorChunk(request, errorId, x);\n        return serializeByRefID(errorId);\n      }\n    }\n  }\n\n  if (value === null) {\n    return null;\n  }\n\n  if (typeof value === 'object') {\n    if (isModuleReference(value)) {\n      const moduleReference: ModuleReference<any> = (value: any);\n      const moduleKey: ModuleKey = getModuleKey(moduleReference);\n      const writtenModules = request.writtenModules;\n      const existingId = writtenModules.get(moduleKey);\n      if (existingId !== undefined) {\n        if (parent[0] === REACT_ELEMENT_TYPE && key === '1') {\n          // If we're encoding the \"type\" of an element, we can refer\n          // to that by a lazy reference instead of directly since React\n          // knows how to deal with lazy values. This lets us suspend\n          // on this component rather than its parent until the code has\n          // loaded.\n          return serializeByRefID(existingId);\n        }\n        return serializeByValueID(existingId);\n      }\n      try {\n        const moduleMetaData: ModuleMetaData = resolveModuleMetaData(\n          request.bundlerConfig,\n          moduleReference,\n        );\n        request.pendingChunks++;\n        const moduleId = request.nextChunkId++;\n        emitModuleChunk(request, moduleId, moduleMetaData);\n        writtenModules.set(moduleKey, moduleId);\n        if (parent[0] === REACT_ELEMENT_TYPE && key === '1') {\n          // If we're encoding the \"type\" of an element, we can refer\n          // to that by a lazy reference instead of directly since React\n          // knows how to deal with lazy values. This lets us suspend\n          // on this component rather than its parent until the code has\n          // loaded.\n          return serializeByRefID(moduleId);\n        }\n        return serializeByValueID(moduleId);\n      } catch (x) {\n        request.pendingChunks++;\n        const errorId = request.nextChunkId++;\n        emitErrorChunk(request, errorId, x);\n        return serializeByValueID(errorId);\n      }\n    } else if ((value: any).$$typeof === REACT_PROVIDER_TYPE) {\n      const providerKey = ((value: any): ReactProviderType<any>)._context\n        ._globalName;\n      const writtenProviders = request.writtenProviders;\n      let providerId = writtenProviders.get(key);\n      if (providerId === undefined) {\n        request.pendingChunks++;\n        providerId = request.nextChunkId++;\n        writtenProviders.set(providerKey, providerId);\n        emitProviderChunk(request, providerId, providerKey);\n      }\n      return serializeByValueID(providerId);\n    } else if (value === POP) {\n      popProvider();\n      if (__DEV__) {\n        insideContextProps = null;\n        isInsideContextValue = false;\n      }\n      return (undefined: any);\n    }\n\n    if (__DEV__) {\n      if (value !== null && !isArray(value)) {\n        // Verify that this is a simple plain object.\n        if (objectName(value) !== 'Object') {\n          console.error(\n            'Only plain objects can be passed to client components from server components. ' +\n              'Built-ins like %s are not supported. ' +\n              'Remove %s from these props: %s',\n            objectName(value),\n            describeKeyForErrorMessage(key),\n            describeObjectForErrorMessage(parent),\n          );\n        } else if (!isSimpleObject(value)) {\n          console.error(\n            'Only plain objects can be passed to client components from server components. ' +\n              'Classes or other objects with methods are not supported. ' +\n              'Remove %s from these props: %s',\n            describeKeyForErrorMessage(key),\n            describeObjectForErrorMessage(parent, key),\n          );\n        } else if (Object.getOwnPropertySymbols) {\n          const symbols = Object.getOwnPropertySymbols(value);\n          if (symbols.length > 0) {\n            console.error(\n              'Only plain objects can be passed to client components from server components. ' +\n                'Objects with symbol properties like %s are not supported. ' +\n                'Remove %s from these props: %s',\n              symbols[0].description,\n              describeKeyForErrorMessage(key),\n              describeObjectForErrorMessage(parent, key),\n            );\n          }\n        }\n      }\n    }\n\n    return value;\n  }\n\n  if (typeof value === 'string') {\n    return escapeStringValue(value);\n  }\n\n  if (\n    typeof value === 'boolean' ||\n    typeof value === 'number' ||\n    typeof value === 'undefined'\n  ) {\n    return value;\n  }\n\n  if (typeof value === 'function') {\n    if (/^on[A-Z]/.test(key)) {\n      throw new Error(\n        'Event handlers cannot be passed to client component props. ' +\n          `Remove ${describeKeyForErrorMessage(\n            key,\n          )} from these props if possible: ${describeObjectForErrorMessage(\n            parent,\n          )}\n` +\n          'If you need interactivity, consider converting part of this to a client component.',\n      );\n    } else {\n      throw new Error(\n        'Functions cannot be passed directly to client components ' +\n          \"because they're not serializable. \" +\n          `Remove ${describeKeyForErrorMessage(key)} (${value.displayName ||\n            value.name ||\n            'function'}) from this object, or avoid the entire object: ${describeObjectForErrorMessage(\n            parent,\n          )}`,\n      );\n    }\n  }\n\n  if (typeof value === 'symbol') {\n    const writtenSymbols = request.writtenSymbols;\n    const existingId = writtenSymbols.get(value);\n    if (existingId !== undefined) {\n      return serializeByValueID(existingId);\n    }\n    const name = value.description;\n\n    if (Symbol.for(name) !== value) {\n      throw new Error(\n        'Only global symbols received from Symbol.for(...) can be passed to client components. ' +\n          `The symbol Symbol.for(${value.description}) cannot be found among global symbols. ` +\n          `Remove ${describeKeyForErrorMessage(\n            key,\n          )} from this object, or avoid the entire object: ${describeObjectForErrorMessage(\n            parent,\n          )}`,\n      );\n    }\n\n    request.pendingChunks++;\n    const symbolId = request.nextChunkId++;\n    emitSymbolChunk(request, symbolId, name);\n    writtenSymbols.set(value, symbolId);\n    return serializeByValueID(symbolId);\n  }\n\n  // $FlowFixMe: bigint isn't added to Flow yet.\n  if (typeof value === 'bigint') {\n    throw new Error(\n      `BigInt (${value}) is not yet supported in client component props. ` +\n        `Remove ${describeKeyForErrorMessage(\n          key,\n        )} from this object or use a plain number instead: ${describeObjectForErrorMessage(\n          parent,\n        )}`,\n    );\n  }\n\n  throw new Error(\n    `Type ${typeof value} is not supported in client component props. ` +\n      `Remove ${describeKeyForErrorMessage(\n        key,\n      )} from this object, or avoid the entire object: ${describeObjectForErrorMessage(\n        parent,\n      )}`,\n  );\n}\n\nfunction logRecoverableError(request: Request, error: mixed): void {\n  const onError = request.onError;\n  onError(error);\n}\n\nfunction fatalError(request: Request, error: mixed): void {\n  // This is called outside error handling code such as if an error happens in React internals.\n  if (request.destination !== null) {\n    request.status = CLOSED;\n    closeWithError(request.destination, error);\n  } else {\n    request.status = CLOSING;\n    request.fatalError = error;\n  }\n}\n\nfunction emitErrorChunk(request: Request, id: number, error: mixed): void {\n  // TODO: We should not leak error messages to the client in prod.\n  // Give this an error code instead and log on the server.\n  // We can serialize the error in DEV as a convenience.\n  let message;\n  let stack = '';\n  try {\n    if (error instanceof Error) {\n      // eslint-disable-next-line react-internal/safe-string-coercion\n      message = String(error.message);\n      // eslint-disable-next-line react-internal/safe-string-coercion\n      stack = String(error.stack);\n    } else {\n      message = 'Error: ' + (error: any);\n    }\n  } catch (x) {\n    message = 'An error occurred but serializing the error message failed.';\n  }\n\n  const processedChunk = processErrorChunk(request, id, message, stack);\n  request.completedErrorChunks.push(processedChunk);\n}\n\nfunction emitModuleChunk(\n  request: Request,\n  id: number,\n  moduleMetaData: ModuleMetaData,\n): void {\n  const processedChunk = processModuleChunk(request, id, moduleMetaData);\n  request.completedModuleChunks.push(processedChunk);\n}\n\nfunction emitSymbolChunk(request: Request, id: number, name: string): void {\n  const processedChunk = processSymbolChunk(request, id, name);\n  request.completedModuleChunks.push(processedChunk);\n}\n\nfunction emitProviderChunk(\n  request: Request,\n  id: number,\n  contextName: string,\n): void {\n  const processedChunk = processProviderChunk(request, id, contextName);\n  request.completedJSONChunks.push(processedChunk);\n}\n\nfunction retryTask(request: Request, task: Task): void {\n  if (task.status !== PENDING) {\n    // We completed this by other means before we had a chance to retry it.\n    return;\n  }\n  switchContext(task.context);\n  try {\n    let value = task.model;\n    while (\n      typeof value === 'object' &&\n      value !== null &&\n      (value: any).$$typeof === REACT_ELEMENT_TYPE\n    ) {\n      // TODO: Concatenate keys of parents onto children.\n      const element: React$Element<any> = (value: any);\n      // Attempt to render the server component.\n      // Doing this here lets us reuse this same task if the next component\n      // also suspends.\n      task.model = value;\n      value = attemptResolveElement(\n        element.type,\n        element.key,\n        element.ref,\n        element.props,\n      );\n    }\n    const processedChunk = processModelChunk(request, task.id, value);\n    request.completedJSONChunks.push(processedChunk);\n    request.abortableTasks.delete(task);\n    task.status = COMPLETED;\n  } catch (x) {\n    if (typeof x === 'object' && x !== null && typeof x.then === 'function') {\n      // Something suspended again, let's pick it back up later.\n      const ping = task.ping;\n      x.then(ping, ping);\n      return;\n    } else {\n      request.abortableTasks.delete(task);\n      task.status = ERRORED;\n      logRecoverableError(request, x);\n      // This errored, we need to serialize this error to the\n      emitErrorChunk(request, task.id, x);\n    }\n  }\n}\n\nfunction performWork(request: Request): void {\n  const prevDispatcher = ReactCurrentDispatcher.current;\n  const prevCache = getCurrentCache();\n  ReactCurrentDispatcher.current = Dispatcher;\n  setCurrentCache(request.cache);\n  prepareToUseHooksForRequest(request);\n\n  try {\n    const pingedTasks = request.pingedTasks;\n    request.pingedTasks = [];\n    for (let i = 0; i < pingedTasks.length; i++) {\n      const task = pingedTasks[i];\n      retryTask(request, task);\n    }\n    if (request.destination !== null) {\n      flushCompletedChunks(request, request.destination);\n    }\n  } catch (error) {\n    logRecoverableError(request, error);\n    fatalError(request, error);\n  } finally {\n    ReactCurrentDispatcher.current = prevDispatcher;\n    setCurrentCache(prevCache);\n    resetHooksForRequest();\n  }\n}\n\nfunction abortTask(task: Task, request: Request, errorId: number): void {\n  task.status = ABORTED;\n  // Instead of emitting an error per task.id, we emit a model that only\n  // has a single value referencing the error.\n  const ref = serializeByValueID(errorId);\n  const processedChunk = processReferenceChunk(request, task.id, ref);\n  request.completedJSONChunks.push(processedChunk);\n}\n\nfunction flushCompletedChunks(\n  request: Request,\n  destination: Destination,\n): void {\n  beginWriting(destination);\n  try {\n    // We emit module chunks first in the stream so that\n    // they can be preloaded as early as possible.\n    const moduleChunks = request.completedModuleChunks;\n    let i = 0;\n    for (; i < moduleChunks.length; i++) {\n      request.pendingChunks--;\n      const chunk = moduleChunks[i];\n      const keepWriting: boolean = writeChunkAndReturn(destination, chunk);\n      if (!keepWriting) {\n        request.destination = null;\n        i++;\n        break;\n      }\n    }\n    moduleChunks.splice(0, i);\n    // Next comes model data.\n    const jsonChunks = request.completedJSONChunks;\n    i = 0;\n    for (; i < jsonChunks.length; i++) {\n      request.pendingChunks--;\n      const chunk = jsonChunks[i];\n      const keepWriting: boolean = writeChunkAndReturn(destination, chunk);\n      if (!keepWriting) {\n        request.destination = null;\n        i++;\n        break;\n      }\n    }\n    jsonChunks.splice(0, i);\n    // Finally, errors are sent. The idea is that it's ok to delay\n    // any error messages and prioritize display of other parts of\n    // the page.\n    const errorChunks = request.completedErrorChunks;\n    i = 0;\n    for (; i < errorChunks.length; i++) {\n      request.pendingChunks--;\n      const chunk = errorChunks[i];\n      const keepWriting: boolean = writeChunkAndReturn(destination, chunk);\n      if (!keepWriting) {\n        request.destination = null;\n        i++;\n        break;\n      }\n    }\n    errorChunks.splice(0, i);\n  } finally {\n    completeWriting(destination);\n  }\n  flushBuffered(destination);\n  if (request.pendingChunks === 0) {\n    // We're done.\n    close(destination);\n  }\n}\n\nexport function startWork(request: Request): void {\n  scheduleWork(() => performWork(request));\n}\n\nexport function startFlowing(request: Request, destination: Destination): void {\n  if (request.status === CLOSING) {\n    request.status = CLOSED;\n    closeWithError(destination, request.fatalError);\n    return;\n  }\n  if (request.status === CLOSED) {\n    return;\n  }\n  if (request.destination !== null) {\n    // We're already flowing.\n    return;\n  }\n  request.destination = destination;\n  try {\n    flushCompletedChunks(request, destination);\n  } catch (error) {\n    logRecoverableError(request, error);\n    fatalError(request, error);\n  }\n}\n\n// This is called to early terminate a request. It creates an error at all pending tasks.\nexport function abort(request: Request, reason: mixed): void {\n  try {\n    const abortableTasks = request.abortableTasks;\n    if (abortableTasks.size > 0) {\n      // We have tasks to abort. We'll emit one error row and then emit a reference\n      // to that row from every row that's still remaining.\n      const error =\n        reason === undefined\n          ? new Error('The render was aborted by the server without a reason.')\n          : reason;\n\n      logRecoverableError(request, error);\n      request.pendingChunks++;\n      const errorId = request.nextChunkId++;\n      emitErrorChunk(request, errorId, error);\n      abortableTasks.forEach(task => abortTask(task, request, errorId));\n      abortableTasks.clear();\n    }\n    if (request.destination !== null) {\n      flushCompletedChunks(request, request.destination);\n    }\n  } catch (error) {\n    logRecoverableError(request, error);\n    fatalError(request, error);\n  }\n}\n\nfunction importServerContexts(\n  contexts?: Array<[string, ServerContextJSONValue]>,\n) {\n  if (contexts) {\n    const prevContext = getActiveContext();\n    switchContext(rootContextSnapshot);\n    for (let i = 0; i < contexts.length; i++) {\n      const [name, value] = contexts[i];\n      const context = getOrCreateServerContext(name);\n      pushProvider(context, value);\n    }\n    const importedContext = getActiveContext();\n    switchContext(prevContext);\n    return importedContext;\n  }\n  return rootContextSnapshot;\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {ReactModel} from 'react-server/src/ReactFlightServer';\nimport type {\n  BundlerConfig,\n  Destination,\n} from './ReactFlightNativeRelayServerHostConfig';\n\nimport {\n  createRequest,\n  startWork,\n  startFlowing,\n} from 'react-server/src/ReactFlightServer';\n\nfunction render(\n  model: ReactModel,\n  destination: Destination,\n  config: BundlerConfig,\n): void {\n  const request = createRequest(model, config);\n  startWork(request);\n  startFlowing(request, destination);\n}\n\nexport {render};\n"],"names":["ReactSharedInternals","React","error","format","args","printWarning","level","ReactDebugCurrentFrame","stack","getStackAddendum","concat","argsWithFormat","map","item","String","unshift","Function","prototype","apply","call","console","hasOwnProperty","Object","isArrayImpl","Array","isArray","a","isModuleReference","reference","JSResourceReferenceImpl","getModuleKey","resolveModuleMetaData","config","resource","resolveModuleMetaDataImpl","processErrorChunk","request","id","message","convertModelToJSON","parent","key","model","json","resolveModelToJSON","jsonArray","i","length","jsonObj","nextKey","processModelChunk","processModuleChunk","moduleMetaData","processProviderChunk","contextName","processSymbolChunk","name","scheduleWork","callback","writeChunkAndReturn","destination","chunk","emitRow","closeWithError","close","REACT_ELEMENT_TYPE","Symbol","for","REACT_FRAGMENT_TYPE","REACT_PROVIDER_TYPE","REACT_SERVER_CONTEXT_TYPE","REACT_FORWARD_REF_TYPE","REACT_MEMO_TYPE","REACT_LAZY_TYPE","REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED","textEncoder","TextEncoder","stringToPrecomputedChunk","content","encode","END_TAG","INSTANCE_TAG","PLACEHOLDER_TAG","SUSPENSE_PENDING_TAG","SUSPENSE_COMPLETE_TAG","SUSPENSE_CLIENT_RENDER_TAG","SEGMENT_TAG","SUSPENSE_UPDATE_TO_COMPLETE_TAG","SUSPENSE_UPDATE_TO_CLIENT_RENDER_TAG","END","Uint8Array","PLACEHOLDER","INSTANCE","SUSPENSE_PENDING","SUSPENSE_COMPLETE","SUSPENSE_CLIENT_RENDER","SEGMENT","SUSPENSE_UPDATE_TO_COMPLETE","SUSPENSE_UPDATE_TO_CLIENT_RENDER","RAW_TEXT","rendererSigil","rootContextSnapshot","currentActiveSnapshot","popNode","prev","context","_currentValue","parentValue","pushNode","next","value","popToNearestCommonAncestor","parentPrev","parentNext","Error","popAllPrevious","pushAllNext","popPreviousToCommonLevel","depth","popNextToCommonLevel","switchContext","newSnapshot","pushProvider","nextValue","prevValue","_currentRenderer","undefined","prevNode","newNode","popProvider","prevSnapshot","_defaultValue","getActiveContext","readContext","isPrimaryRenderer","currentRequest","prepareToUseHooksForRequest","resetHooksForRequest","$$typeof","currentCache","readContextImpl","Dispatcher","useMemo","nextCreate","useCallback","useDebugValue","useDeferredValue","unsupportedHook","useTransition","getCacheForType","resourceType","entry","get","set","useContext","useReducer","useRef","useState","useInsertionEffect","useLayoutEffect","useImperativeHandle","useEffect","useId","useMutableSource","useSyncExternalStore","useCacheRefresh","unsupportedRefresh","setCurrentCache","cache","getCurrentCache","identifierCount","identifierPrefix","toString","ContextRegistry","getOrCreateServerContext","globalName","createServerContext","PENDING","COMPLETED","ERRORED","ReactCurrentDispatcher","defaultErrorHandler","OPEN","CLOSING","CLOSED","createRequest","bundlerConfig","onError","abortSet","Set","pingedTasks","status","fatalError","Map","nextChunkId","pendingChunks","abortableTasks","completedModuleChunks","completedJSONChunks","completedErrorChunks","writtenSymbols","writtenModules","writtenProviders","toJSON","rootContext","createRootContext","rootTask","createTask","push","reqContext","importServerContexts","POP","attemptResolveElement","type","ref","props","children","payload","_payload","init","_init","wrappedType","render","_context","extraKeys","keys","filter","JSON","stringify","__pop","describeValueForErrorMessage","pingTask","task","performWork","ping","add","serializeByValueID","serializeByRefID","escapeStringValue","isObjectPrototype","object","ObjectPrototype","getPrototypeOf","names","getOwnPropertyNames","isSimpleObject","descriptor","getOwnPropertyDescriptor","enumerable","objectName","replace","m","p0","describeKeyForErrorMessage","encodedKey","substr","describeObjectForErrorMessage","objectOrArray","expandedName","str","array","insideContextProps","isInsideContextValue","originalValue","element","x","then","newTask","logRecoverableError","errorId","emitErrorChunk","moduleReference","moduleKey","existingId","moduleId","emitModuleChunk","providerKey","_globalName","providerId","emitProviderChunk","getOwnPropertySymbols","symbols","description","test","displayName","symbolId","emitSymbolChunk","processedChunk","retryTask","delete","prevDispatcher","current","prevCache","flushCompletedChunks","beginWriting","moduleChunks","keepWriting","splice","jsonChunks","errorChunks","completeWriting","startWork","startFlowing","contexts","prevContext","importedContext"],"mappings":"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"}